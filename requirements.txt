# MLOps Lab – Airflow + Gaussian Mixture Model (GMM)

This lab demonstrates an end-to-end **MLOps pipeline orchestrated with Apache Airflow**, where clustering is performed using a **Gaussian Mixture Model (GMM)** instead of K-Means. The workflow includes data loading, preprocessing, model training, model persistence, and cluster evaluation — all managed through an Airflow DAG.

---

## Model Overview – Gaussian Mixture Model (GMM)


Unlike K-Means (hard clustering), **GMM** performs **probabilistic (soft) clustering**.
Each data point belongs to clusters with certain probabilities.

**Why GMM?**

* Handles elliptical clusters (not just spherical).
* Captures cluster covariance structure.
* Provides probability scores (`predict_proba`).
* More flexible for real-world distributions.

Typical stack:

* `pandas`
* `scikit-learn`
* `pickle`
* `apache-airflow`
* `docker`

---

## Pipeline Architecture (Airflow DAG)

The DAG runs tasks sequentially:

```
load_data 
   ↓
data_preprocessing 
   ↓
build_save_gmm_model 
   ↓
load_model_and_evaluate
```

Each task is implemented using `PythonOperator`, and XCom is used to pass serialized outputs between tasks.

---

## Setup & Start Airflow

From the project root:

```bash
docker compose up airflow-init
docker compose up
```

Wait until the webserver health check appears in logs.

---

## Access Airflow UI

Open:

```
http://localhost:8080
```

Click **Trigger DAG**.

---

## Monitor Execution

* View task graph
* Check logs per task
* Confirm model file saved in `working_data/`
* Inspect clustering results

---

## Key Difference from Original Lab

| Original Lab       | This Lab                       |
| ------------------ | ------------------------------ |
| K-Means            | Gaussian Mixture Model         |
| Hard clustering    | Soft probabilistic clustering  |

---

## Stop Containers

```bash
docker compose down
```

---

## Outcome

After successful execution:

* GMM model is saved
* Clustering probabilities generated
* Fully reproducible workflow via Airflow

---
